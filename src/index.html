<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link href="data:image/svg+xml,%3csvg/%3e" rel="icon">
    <title>kampong</title>
  </head>
  <body>
    <h1>HELLO</h1>
    <center><h1><img src="logo.svg"</h1></center>
    <center><h3>Welcome to the MoleDAO Hackathon</h3></center>
    <div id="auth" class="main">
      <button class="login">Login</button>
      <div class="error"></div>
      <div class="dialog"></div>
    </div>
    <div id="app" class="hidden"></div>
    <script>
      // Frontpage Ping config
      let STATE = {path: '/kampong', chains: [1, 4, 100]};
    </script>
    <script src="https://www.frontpageping.com/out/app-7ff7ded.js" type="text/javascript"></script>
    <script src="auth/push.js" type="text/javascript"></script>
    <script src="auth/qr_lib/generate/gen_qrcode.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>

    <script>

      // Silent Auth config
      document.querySelector('.login')
        .addEventListener('click', sl_auth);

      // wire up
      document.addEventListener('authentication', (e) => {
        if (e.result == 'allowed') {
          document.querySelector('#app').classList.remove('hidden');
          document.querySelector('#auth').classList.add('hidden');
          
          
          // authentication successful
          
          async function createLivenessSignature(){

            console.log("loading web3")
            if (window.ethereum != null){
              console.log("provider found")
            }
            const web3 = new Web3(window.ethereum);
            web3.eth.getAccounts(console.log);

            
            // let accounts = await ethereum.request({ method: 'eth_requestAccounts' });
            // // keccak256 hash of string "hello"
            // let messageHash = "0x1c8aff950685c2ed4bc3174f3472287b56d9517b9c948127319a09a7a36deac8";
            // let signature = await ethereum.request({ method: 'eth_sign', params: [accounts[0], messageHash] });
            // console.log(signature);

            
            var contract = web3.eth.contract(abiArray).at(contractAddress);

            var result = contract.methodName(mintNFT).call(); 

            //show success
            

          }

          createLivenessSignature();



        } else {
          document.querySelector('.error').innerHTML = `Please try login in again`;
        }
      }, false);
    </script>

    

  </body>
</html>
